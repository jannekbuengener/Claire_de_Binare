# 3-Tage-Block: 30.11.2025 - 03.12.2025

**Status**: üü¢ AKTIV
**Start**: 2025-11-30 07:54:00 UTC
**Ende (geplant)**: 2025-12-03 07:54:00 UTC (72h)

---

## BLOCK-KONFIGURATION

### Systemkonfiguration
```yaml
Signal Engine:
  threshold_pct: 2.0          # Gesenkt von 3.0%
  lookback_minutes: 15
  min_volume: 0
  rsi_filter: true            # NEU: RSI > 50 f√ºr LONG

Risk Manager:
  max_position_pct: 0.10      # 10% pro Position
  max_exposure_pct: 0.50      # 50% Gesamt-Exposure
  max_daily_drawdown_pct: 0.05
  circuit_breaker_pct: 0.10
  redis_persistence: true     # NEU: State-Persistence

Execution:
  mode: paper_trading
  executor: MockExecutor
  realistic_pricing: true     # NEU: Signal-Price propagation
  db_persistence: true        # NEU: Schema-aligned
```

### Aktive Fixes (seit 30.11.2025)
1. ‚úÖ Redis-Persistence f√ºr Risk-State
2. ‚úÖ Signal-Price Propagation (Exposure-Bug fix)
3. ‚úÖ DB Schema Alignment (Column names)
4. ‚úÖ MEXC Volume-Bug Fix (field "q")
5. ‚úÖ RSI Filter Implementation
6. ‚úÖ Signal Threshold Reduction (3.0% ‚Üí 2.0%)

---

## BASELINE-METRIKEN (Start)

### System Health
```
Timestamp: 2025-11-30 07:54:00 UTC
Services: 9/10 healthy (cdb_paper_runner cosmetic unhealthy)
Event-Flow: ‚úÖ Vollst√§ndig funktional
```

### Signal Engine
```
Signals Generated: 81 (in ersten 6min nach Deployment)
Signal Rate: ~13.5 signals/min
Threshold: 2.0%
RSI Filter: Aktiv
Last Signal: LAZIO_USDT BUY @ 07:53:46
```

### Risk Manager
```
Exposure: 50,059 USDT (100.1% Limit)
Open Positions: ~31
Signals Approved: 259+ (lifetime)
Signals Blocked: Unknown (zu tracken)
Circuit Breaker: Inactive
Redis Persistence: Active
```

### Execution Service
```
Orders Executed: 259+ (lifetime)
DB Persistence: ‚úÖ Error-free
Realistic Pricing: ‚úÖ Active
Avg Slippage: ~0.02% (base)
```

---

## ERWARTETE KPIs (72h)

### Handelsfrequenz (PRIMARY GOAL)
```
Ziel: 5-8 Trades/Tag (120-192 Trades total)
Aktuell: Exposure-Limit erreicht ‚Üí erwarte 0 neue Trades bis Reset

‚ö†Ô∏è WICHTIG: Exposure bei 100% ‚Üí System wird keine neuen Trades machen!
‚Üí Entweder Exposure-Limit erh√∂hen ODER Positionen schlie√üen
```

### Signalqualit√§t
```
Target Winrate: ‚â• 50%
Target Profit Factor: ‚â• 1.0
Max Daily Drawdown: ‚â§ 5%
```

### System-Stabilit√§t
```
Uptime Target: ‚â• 99%
Zero-Activity Tolerance: ‚â§ 4h (bei vorhandenem Signal-Flow)
DB Error Rate: 0%
Redis Persistence Failures: 0
```

---

## MONITORING-PLAN

### T√§glich (24h, 48h, 72h)
- [ ] Service Health Check (alle Container)
- [ ] Signal Generation Rate (Signale/Tag)
- [ ] Risk Approval Rate (Approved/Total %)
- [ ] Exposure Level (aktuell vs. Limit)
- [ ] Circuit Breaker Status
- [ ] DB Persistence Errors
- [ ] Redis State Integrity

### Bei Incidents
- [ ] Full 6-Layer Analysis
- [ ] Log Extraction (alle Services)
- [ ] Event-Flow Verification
- [ ] Root-Cause Dokumentation

---

## ENTSCHEIDUNGSPUNKTE

### Exposure-Management (SOFORT)
**Problem**: Exposure bei 100% Limit (50,059 USDT)
**Optionen**:
1. **Exposure-Limit erh√∂hen** (z.B. auf 100k USDT f√ºr Paper-Trading)
   - Pro: Mehr Trades m√∂glich
   - Contra: H√∂heres Risk-Exposure (aber nur Paper!)
2. **Position-Closing implementieren**
   - Pro: Realistischer Handelszyklus
   - Contra: Braucht Exit-Logik
3. **Exposure-Reset** (manuell via Redis)
   - Pro: Quick-Fix
   - Contra: Verlust von State-Tracking

**Empfehlung**: Option 1 f√ºr Paper-Trading Phase
```bash
# .env
MAX_EXPOSURE_PCT=1.0  # 100% statt 50% f√ºr Paper-Trading
```

### RSI Filter Evaluation (nach 24h)
**Fragen**:
- Wie viele Signale werden durch RSI gefiltert?
- Impact auf Signal-Rate?
- Impact auf Winrate (wenn messbar)?

**Action**: Debug-Logging aktivieren f√ºr RSI-Rejections
```python
# signal_engine/service.py
logger.info(f"{symbol}: RSI Filter ‚Üí rejected (RSI={rsi:.1f})")
```

### Adaptive Intensity (nach 72h)
**Gate-Kriterien**:
- Min 300 Trades executed
- Winrate ‚â• 50%
- Max Drawdown ‚â§ 5%
- Keine kritischen Incidents

**Wenn erf√ºllt**: Design Adaptive Intensity System
**Wenn nicht**: Bleibe bei aktueller Config

---

## RISIKEN & MITIGATIONS

### Risiko 1: Zero-Activity durch Exposure-Limit
**Wahrscheinlichkeit**: HOCH (bereits eingetreten)
**Impact**: Block liefert keine Trade-Daten
**Mitigation**: Exposure-Limit auf 100% erh√∂hen (siehe Entscheidungspunkt)

### Risiko 2: Redis State Loss
**Wahrscheinlichkeit**: NIEDRIG (Persistence aktiv)
**Impact**: Exposure-Reset, potentiell Deadlock
**Mitigation**: Redis Persistence mit 7-Tage TTL, t√§glich verifizieren

### Risiko 3: DB Schema Drift
**Wahrscheinlichkeit**: NIEDRIG (gerade fixed)
**Impact**: Logging-Failures
**Mitigation**: E2E Tests f√ºr DB-Writes, t√§glich Error-Rate checken

### Risiko 4: MEXC API Changes
**Wahrscheinlichkeit**: NIEDRIG
**Impact**: Volume-Daten oder Klines brechen
**Mitigation**: Health-Checks auf cdb_ws, Fallback-Logik

---

## BLOCK-GOALS

### Must-Have (Blocker f√ºr n√§chsten Block)
1. ‚úÖ System l√§uft 72h stabil (Uptime ‚â• 99%)
2. ‚è≥ Min 120 Trades executed (5/Tag Target)
3. ‚è≥ Keine kritischen Incidents (ZAI, Deadlocks, DB-Failures)
4. ‚è≥ Event-Flow funktional √ºber gesamte Laufzeit

### Should-Have (Nice-to-Have)
1. ‚è≥ Winrate ‚â• 50%
2. ‚è≥ Profit Factor ‚â• 1.0
3. ‚è≥ RSI Filter Impact messbar
4. ‚è≥ Grafana Alerts konfiguriert

### Could-Have (Future Work)
1. Position-Closing Logik
2. Adaptive Intensity Design
3. E2E Tests f√ºr alle Fixes
4. Prometheus Alert Rules

---

## CHECKPOINTS

### 24h Checkpoint (31.11.2025 07:54 UTC)
**Zu pr√ºfen**:
- [ ] Uptime ‚â• 23h
- [ ] Signals Generated ‚â• 500
- [ ] Trades Executed ‚â• 40 (bei gel√∂stem Exposure-Limit)
- [ ] Keine Circuit-Breaker Aktivierungen
- [ ] Redis State Persistence funktional

**Falls Exposure-Limit nicht gel√∂st**:
- [ ] Entscheidung: Limit erh√∂hen oder Block abbrechen

### 48h Checkpoint (01.12.2025 07:54 UTC)
**Zu pr√ºfen**:
- [ ] Uptime ‚â• 47h
- [ ] Signals Generated ‚â• 1000
- [ ] Trades Executed ‚â• 80
- [ ] Winrate-Trend erkennbar
- [ ] Keine Zero-Activity Perioden > 4h

### 72h Checkpoint (03.12.2025 07:54 UTC)
**Zu pr√ºfen**:
- [ ] Uptime ‚â• 71h
- [ ] Signals Generated ‚â• 1500
- [ ] Trades Executed ‚â• 120
- [ ] Winrate berechnet
- [ ] Profit Factor berechnet
- [ ] Drawdown-Statistiken

**Post-Block Analysis**:
- [ ] Full Session Report erstellen
- [ ] 6-Layer Analysis
- [ ] Root-Cause f√ºr alle Incidents
- [ ] Recommendations f√ºr n√§chsten Block

---

## LOGS & ARTIFACTS

### Log-Locations
```
Service Logs: docker logs <service_name>
DB Queries: docker exec cdb_postgres psql -U claire_user -d claire_de_binare
Redis State: docker exec cdb_redis redis-cli GET "risk_state:persistence"
Prometheus: http://localhost:9090
Grafana: http://localhost:3000
```

### Zu sammelnde Metriken
```sql
-- Signals
SELECT COUNT(*) FROM signals WHERE created_at >= '2025-11-30 07:54:00';

-- Orders
SELECT COUNT(*), status FROM orders
WHERE submitted_at >= '2025-11-30 07:54:00'
GROUP BY status;

-- Trades
SELECT COUNT(*), SUM(size * execution_price) as total_exposure
FROM trades
WHERE timestamp >= '2025-11-30 07:54:00';

-- Winrate (wenn PnL tracking aktiv)
SELECT
  COUNT(*) as total_trades,
  COUNT(*) FILTER (WHERE pnl > 0) as wins,
  COUNT(*) FILTER (WHERE pnl <= 0) as losses,
  ROUND(COUNT(*) FILTER (WHERE pnl > 0)::DECIMAL / COUNT(*) * 100, 2) as winrate_pct
FROM trades
WHERE timestamp >= '2025-11-30 07:54:00' AND pnl IS NOT NULL;
```

---

## INCIDENT-LOG

### 2025-11-30 07:54:00 - Block Start
**Observation**: Exposure bereits bei 100% Limit
**Impact**: Keine neuen Trades m√∂glich
**Action Required**: Exposure-Limit erh√∂hen oder Positionen schlie√üen
**Status**: ‚è≥ OPEN

---

**Ende Planung**
**Block-Status**: üü¢ GESTARTET
**Next Review**: 24h Checkpoint (31.11.2025 07:54 UTC)
