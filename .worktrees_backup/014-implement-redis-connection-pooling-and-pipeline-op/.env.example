# ==================================================================
# Claire de Binare - Environment Configuration Template
# ==================================================================
#
# SECRETS ARCHITECTURE (Blueprint-compliant):
# - Secrets are stored in: ~/Documents/.secrets/.cdb/ (Single Source of Truth)
# - Docker reads secrets via SECRETS_PATH environment variable
# - Never commit actual secrets to git
#
# SETUP:
# 1. Create secrets directory: mkdir -p ~/Documents/.secrets/.cdb
# 2. Generate secrets: openssl rand -base64 24 > ~/Documents/.secrets/.cdb/REDIS_PASSWORD
# 3. Or run: ./infrastructure/scripts/init-secrets.ps1 (Windows)
#
# CRITICAL SAFETY CHECKLIST:
# [ ] NEVER commit .env file to git
# [ ] Set MEXC_TESTNET=true for all testing
# [ ] Set DRY_RUN=true until ready for live trading
# [ ] Verify secret files exist before starting stack
# [ ] Keep SIGNAL_STRATEGY_ID=paper for testing
#
# ==================================================================

# ------------------------------------------------------------------
# Secrets Path (REQUIRED for Docker Compose)
# ------------------------------------------------------------------
# Windows: C:\Users\<username>\Documents\.secrets\.cdb
# Linux/Mac: ~/Documents/.secrets/.cdb
SECRETS_PATH=${HOME}/Documents/.secrets/.cdb

# ------------------------------------------------------------------
# Stack Configuration (Issue #232)
# ------------------------------------------------------------------
STACK_NAME=cdb
NETWORK=cdb_network

# ------------------------------------------------------------------
# Redis Configuration
# ------------------------------------------------------------------
REDIS_HOST=cdb_redis
REDIS_PORT=6379
REDIS_DB=0
# Secret loaded from: ${SECRETS_PATH}/REDIS_PASSWORD

# ------------------------------------------------------------------
# PostgreSQL Configuration
# ------------------------------------------------------------------
POSTGRES_HOST=cdb_postgres
POSTGRES_PORT=5432
POSTGRES_USER=claire_user
POSTGRES_DB=claire_de_binare
# Secret loaded from: ${SECRETS_PATH}/POSTGRES_PASSWORD

# ------------------------------------------------------------------
# Monitoring Configuration
# ------------------------------------------------------------------
# Secret loaded from: ${SECRETS_PATH}/GRAFANA_PASSWORD

# ------------------------------------------------------------------
# MEXC Exchange Configuration
# ------------------------------------------------------------------
# Secrets loaded from: ${SECRETS_PATH}/MEXC_API_SECRET.txt
#                      ${SECRETS_PATH}/MEXC_TRADE_API_SECRET.txt

# SAFETY: ALWAYS use testnet for development/testing
MEXC_TESTNET=true

# ------------------------------------------------------------------
# Trading Mode Configuration
# ------------------------------------------------------------------
# DRY_RUN: Log trades without executing (SAFETY: keep true until production-ready)
DRY_RUN=true

# SIGNAL_STRATEGY_ID: Trading strategy identifier
# - "paper" = Paper trading mode (simulated trades, no real money)
# - "live"  = Live trading mode (DANGER: real money at risk)
SIGNAL_STRATEGY_ID=paper

# ------------------------------------------------------------------
# Paper Trading Configuration (Optional)
# ------------------------------------------------------------------
# Duration for automated 14-day paper trading test
# Default: 14 days (if not set)
# PAPER_TRADING_DURATION_DAYS=14

# Logging verbosity for paper trading runner
# Options: DEBUG, INFO, WARNING, ERROR, CRITICAL
# Default: INFO (if not set)
# LOG_LEVEL=INFO

# ------------------------------------------------------------------
# E2E Test Configuration (Issue #226)
# ------------------------------------------------------------------
# Disable circuit breakers for deterministic E2E tests.
# SAFETY: Never enable in production!
# E2E_DISABLE_CIRCUIT_BREAKER=1

# ------------------------------------------------------------------
# Regime Service Configuration (Issue #215)
# ------------------------------------------------------------------
# Market regime detection using ADX/ATR indicators.
# REGIME_ADX_PERIOD=14
# REGIME_ATR_PERIOD=14
# REGIME_ADX_TREND_THRESHOLD=25.0
# REGIME_ADX_RANGE_THRESHOLD=20.0
# REGIME_ATR_HIGH_VOL_THRESHOLD=0.03
# REGIME_CONFIRMATION_BARS=3

# ------------------------------------------------------------------
# Allocation Service Configuration (Issue #215)
# ------------------------------------------------------------------
# ALLOCATION_REGIME_MIN_STABLE_SECONDS=60
# ALLOCATION_RULES_JSON={"default": {"base_pct": 0.1, "max_pct": 0.5}}

# ------------------------------------------------------------------
# Docker Image Digests (Security: Pinned versions)
# ------------------------------------------------------------------
REDIS_IMAGE=redis@sha256:ee64a64eaab618d88051c3ade8f6352d11531fcf79d9a4818b9b183d8c1d18ba
POSTGRES_IMAGE=postgres@sha256:b3968e348b48f1198cc6de6611d055dbad91cd561b7990c406c3fc28d7095b21
PROMETHEUS_IMAGE=prom/prometheus@sha256:2b6f734e372c1b4717008f7d0a0152316aedd4d13ae17ef1e3268dbfaf68041b
GRAFANA_IMAGE=grafana/grafana@sha256:2175aaa91c96733d86d31cf270d5310b278654b03f5718c59de12a865380a31f

# ==================================================================
# QUICK START:
# ==================================================================
# 1. Copy: cp .env.example .env
# 2. Set SECRETS_PATH to your secrets directory
# 3. Run: ./infrastructure/scripts/init-secrets.ps1 (Windows)
#    Or:  ./infrastructure/scripts/init-secrets.sh (Linux/Mac)
# 4. Start: ./infrastructure/scripts/stack_up.ps1
# ==================================================================
